<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Xô Phim - Đẳng Cấp Tết 2026</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        :root { --xo-vang: #d4a017; --bg-dark: #0b0c10; }
        body { background-color: var(--bg-dark); color: #e2e8f0; font-family: 'Inter', sans-serif; overflow-x: hidden; }
        
        /* HEADER CỐ ĐỊNH */
        #header { 
            position: fixed; top: 0; left: 0; width: 100%; z-index: 120;
            background: linear-gradient(to bottom, rgba(160, 0, 0, 0.95) 0%, rgba(130, 0, 0, 0.8) 60%, transparent 100%);
            padding: 15px 20px 30px 20px;
        }

        /* PHÁO HOA NHỎ & TRONG SUỐT */
        #fw-canvas { position: fixed; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: 50; opacity: 0.4; }

        /* MODAL MÈO */
        #tet-alert {
            position: fixed; inset: 0; z-index: 500; display: flex; align-items: center; justify-content: center;
            background: rgba(0,0,0,0.92); backdrop-filter: blur(8px);
        }
        .closing { transform: scale(0) !important; opacity: 0 !important; transition: 0.8s; }

        /* INFO MODAL (Lớp mờ khi ấn xem phim) */
        #info-modal {
            position: fixed; inset: 0; z-index: 400; display: none; align-items: center; justify-content: center;
            background: rgba(0,0,0,0.85); backdrop-filter: blur(15px); padding: 20px;
        }
        .info-content {
            background: #161b22; border: 1px solid rgba(255,255,255,0.1); border-radius: 24px;
            max-width: 600px; width: 100%; overflow: hidden; position: relative;
        }

        /* Banner Slide */
        .banner-container { height: 85vh; position: relative; transition: 1s; }
        .banner-img { position: absolute; inset: 0; background-size: cover; background-position: center; transition: 1.5s; }
        .banner-img::after { content: ""; position: absolute; inset: 0; background: linear-gradient(to top, var(--bg-dark), transparent); }

        .sakura { position: fixed; top: -10%; z-index: 100; pointer-events: none; background: #ffb7c5; border-radius: 50% 0 50% 50%; animation: fall linear infinite; opacity: 0.6; }
        @keyframes fall { 100% { transform: translateY(110vh) rotate(720deg); opacity: 0; } }

        .ep-list { display: flex; flex-wrap: wrap; gap: 8px; padding: 15px; background: #0b0c10; }
        .ep-item { background: #21262d; padding: 8px 16px; border-radius: 8px; font-size: 12px; cursor: pointer; border: 1px solid transparent; }
        .ep-item.active { border-color: var(--xo-vang); color: var(--xo-vang); }
    </style>
</head>
<body>

    <canvas id="fw-canvas"></canvas>
    <audio id="tet-music" loop><source src="https://api.mp3.zing.vn/api/streaming/audio/ZW67O70C/320" type="audio/mpeg"></audio>

    <div id="tet-alert">
        <div class="alert-box text-center bg-[#8B0000] p-10 rounded-[40px] border-4 border-[#d4a017]">
            <h2 class="text-2xl font-black mb-3 text-yellow-400 italic uppercase">Thông Báo Tết</h2>
            <div class="w-[110px] h-[110px] mx-auto rounded-full border-4 border-[#d4a017] overflow-hidden cursor-pointer shadow-lg shadow-yellow-500/30" onclick="closeAlertAndPlay()">
                <img src="https://jbagy.me/wp-content/uploads/2025/04/Hinh-meme-meo-cuoi-deu-1.jpg" class="w-full h-full object-cover">
            </div>
            <p class="text-[10px] text-yellow-500 font-bold mt-4 uppercase">Chạm Mèo để nghe nhạc & xem phim</p>
        </div>
    </div>

    <header id="header">
        <div class="flex items-center justify-between max-w-7xl mx-auto">
            <div class="flex items-center gap-2">
                <div class="w-9 h-8 bg-[#d4a017] rounded-b-xl flex items-center justify-center"><i class="fas fa-play text-black text-xs"></i></div>
                <div class="flex flex-col leading-none text-white"><span class="text-xl font-black uppercase">Xô Phim</span></div>
            </div>
            <div class="bg-white text-black px-5 py-1.5 rounded-full text-xs font-black">Thành viên</div>
        </div>
    </header>

    <section class="banner-container flex flex-col justify-end items-center pb-24 text-center px-6">
        <div id="banner-bg" class="banner-img"></div>
        <div class="relative z-10">
            <h1 id="b-title" class="text-4xl md:text-7xl font-black italic uppercase drop-shadow-2xl">--</h1>
            <p id="b-sub" class="text-yellow-500 text-sm font-bold mt-2 uppercase tracking-widest">--</p>
            <button onclick="showCurrentInfo()" class="mt-8 bg-yellow-500 text-black px-12 py-3 rounded-full font-black uppercase text-xs hover:scale-110 transition">Xem Thông Tin</button>
        </div>
    </section>

    <main class="px-6 py-12 max-w-7xl mx-auto relative z-[60]">
        <h2 class="text-xl font-black italic uppercase mb-8 border-l-4 border-red-600 pl-4">Phim Mới Cập Nhật</h2>
        <div id="movie-grid" class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-6 gap-6"></div>
    </main>

    <div id="info-modal" onclick="closeInfo(event)">
        <div class="info-content animate-zoom" onclick="event.stopPropagation()">
            <div class="h-48 w-full bg-cover bg-center relative" id="info-banner">
                <button onclick="closeInfoModal()" class="absolute top-4 right-4 text-white bg-black/50 w-8 h-8 rounded-full"><i class="fas fa-times"></i></button>
            </div>
            <div class="p-6">
                <div class="flex gap-4 items-start mb-4">
                    <img id="info-img" src="" class="w-24 rounded-lg shadow-xl -mt-16 border-2 border-white/10">
                    <div>
                        <h2 id="info-title" class="text-xl font-black text-white uppercase tracking-tight">--</h2>
                        <p id="info-meta" class="text-xs text-yellow-500 font-bold mt-1 uppercase">--</p>
                    </div>
                </div>
                <p id="info-desc" class="text-gray-400 text-xs leading-relaxed mb-6 italic">--</p>
                <button id="btn-play" class="w-full bg-yellow-500 text-black py-3 rounded-xl font-black uppercase text-xs tracking-widest hover:bg-white transition">Bắt Đầu Xem Ngay</button>
            </div>
        </div>
    </div>

    <div id="player-overlay" class="fixed inset-0 z-[600] hidden bg-black flex flex-col">
        <div class="p-4 flex justify-between items-center bg-[#0b0c10] border-b border-white/5">
            <button onclick="closePlayer()" class="text-white text-xl"><i class="fas fa-times"></i></button>
            <h2 id="player-title" class="font-bold text-xs text-gray-400 uppercase">Đang phát</h2>
            <div class="w-6"></div>
        </div>
        <iframe id="main-iframe" class="flex-1 w-full" frameborder="0" allowfullscreen></iframe>
        <div id="episodes-container" class="ep-list no-scrollbar overflow-x-auto"></div>
    </div>

    <script>
        // DANH SÁCH PHIM CỦA ÔNG
        const movies = [
            {
                id: 3, title: "Hố Đen Tử Thần", sub: "Interstellar", year: "2014", rating: "8.7", status: "Full HD",
                desc: "Trong tương lai, khi Trái Đất bị tàn phá bởi hạn hán và biến đổi khí hậu, một nhóm các nhà du hành vũ trụ đi xuyên qua một hố đen để tìm kiếm một hành tinh mới.",
                img: "https://phimapi.com/image.php?url=https://phimimg.com/upload/vod/20250302-1/4cee31c3afd0fbfd11ed4f14b1bfd816.jpg",
                episodes: [{ name: "Full Movie", link: "https://player.phimapi.com/player/?url=https://s4.phim1280.tv/20250302/BLbAWQOK/index.m3u8" }]
            },
            {
                id: 2, title: "Bóng Ma Anh Quốc", sub: "Peaky Blinders", year: "2013 - 2024", rating: "8.8", status: "Season 1-5",
                desc: "Một băng đảng tội phạm khét tiếng ở Birmingham, Anh, vào năm 1919, được dẫn dắt bởi Tommy Shelby hung bạo và mưu mô.",
                img: "https://phimapi.com/image.php?url=https://phimimg.com/upload/vod/20240730-1/b37769fcc6142d1e116b6486f6b7132b.jpg",
                episodes: [
                    { name: "P1-T01", link: "https://player.phimapi.com/player/?url=https://s3.phim1280.tv/20240730/911phIUY/index.m3u8" },
                    { name: "P1-T02", link: "https://player.phimapi.com/player/?url=https://s3.phim1280.tv/20240730/fWRCpaKk/index.m3u8" },
                    { name: "P1-T03", link: "https://player.phimapi.com/player/?url=https://s3.phim1280.tv/20240730/KN724ide/index.m3u8" }
                ]
            }
        ];

        let curSlide = 0;
        let slideTimer;

        // ĐÓNG THÔNG BÁO MÈO
        function closeAlertAndPlay() {
            document.getElementById('tet-alert').classList.add('closing');
            document.getElementById('tet-music').play();
            setTimeout(() => { document.getElementById('tet-alert').style.display = 'none'; startBanner(); }, 800);
        }

        // TỰ ĐỘNG CẬP NHẬT 6 PHIM MỚI
        function init() {
            const grid = document.getElementById('movie-grid');
            grid.innerHTML = '';
            // Lấy 6 phim cuối cùng trong danh sách
            const newMovies = movies.slice(-6).reverse();
            newMovies.forEach((m) => {
                const idxInMain = movies.indexOf(m);
                grid.innerHTML += `
                    <div class="cursor-pointer group" onclick="showInfo(${idxInMain})">
                        <div class="relative aspect-[2/3] rounded-2xl overflow-hidden shadow-xl border border-white/5">
                            <img src="${m.img}" class="w-full h-full object-cover group-hover:scale-110 transition duration-700">
                            <div class="absolute inset-0 bg-black/40 opacity-0 group-hover:opacity-100 transition flex items-center justify-center"><i class="fas fa-info-circle text-2xl text-yellow-500"></i></div>
                        </div>
                        <h3 class="mt-3 font-bold text-[11px] truncate text-gray-400 group-hover:text-yellow-500 uppercase">${m.title}</h3>
                    </div>
                `;
            });
            updateBanner();
        }

        // BANNER AUTO 3S
        function startBanner() {
            slideTimer = setInterval(() => {
                curSlide = (curSlide + 1) % movies.length;
                updateBanner();
            }, 3000);
        }

        function updateBanner() {
            const m = movies[curSlide];
            const bg = document.getElementById('banner-bg');
            bg.style.opacity = 0;
            setTimeout(() => {
                bg.style.backgroundImage = `url('${m.img}')`;
                bg.style.opacity = 1;
                document.getElementById('b-title').innerText = m.title;
                document.getElementById('b-sub').innerText = `${m.sub} • ${m.year}`;
            }, 500);
        }

        // MODAL THÔNG TIN PHIM
        function showInfo(idx) {
            const m = movies[idx];
            document.getElementById('info-modal').style.display = 'flex';
            document.getElementById('info-banner').style.backgroundImage = `url('${m.img}')`;
            document.getElementById('info-img').src = m.img;
            document.getElementById('info-title').innerText = m.title;
            document.getElementById('info-meta').innerText = `${m.year} • ${m.status} • IMDb ${m.rating}`;
            document.getElementById('info-desc').innerText = m.desc;
            document.getElementById('btn-play').onclick = () => { closeInfoModal(); playMovie(idx); };
        }

        function showCurrentInfo() { showInfo(curSlide); }
        function closeInfoModal() { document.getElementById('info-modal').style.display = 'none'; }

        // PHÁO HOA NHỎ
        const cvs = document.getElementById('fw-canvas');
        const ctx = cvs.getContext('2d');
        let pts = [];
        const resize = () => { cvs.width = innerWidth; cvs.height = innerHeight; };
        window.onresize = resize; resize();

        class Pt {
            constructor(x, y, c) {
                this.x = x; this.y = y; this.c = c;
                this.v = { x: (Math.random()-0.5)*4, y: (Math.random()-0.5)*4 };
                this.a = 1;
            }
            draw() { ctx.globalAlpha = this.a; ctx.beginPath(); ctx.arc(this.x, this.y, 1, 0, 7); ctx.fillStyle = this.c; ctx.fill(); }
            up() { this.v.y += 0.02; this.x += this.v.x; this.y += this.v.y; this.a -= 0.01; }
        }

        function createFw() {
            const x = Math.random()*cvs.width, y = Math.random()*cvs.height*0.5;
            const colors = ['#f59e0b', '#ef4444', '#0ea5e9', '#fff'];
            const c = colors[Math.floor(Math.random()*4)];
            for(let i=0; i<15; i++) pts.push(new Pt(x, y, c));
        }
        setInterval(createFw, 1500);
        function loop() {
            ctx.clearRect(0,0,cvs.width,cvs.height);
            pts.forEach((p, i) => { if(p.a > 0) { p.up(); p.draw(); } else pts.splice(i,1); });
            requestAnimationFrame(loop);
        }
        loop();

        // PHÁT PHIM
        function playMovie(i, epIdx = 0) {
            const m = movies[i]; const ep = m.episodes[epIdx];
            document.getElementById('player-title').innerText = `${m.title} - ${ep.name}`;
            document.getElementById('main-iframe').src = ep.link;
            const container = document.getElementById('episodes-container');
            container.innerHTML = '';
            if (m.episodes.length > 1) {
                m.episodes.forEach((e, idx) => {
                    container.innerHTML += `<div class="ep-item ${idx===epIdx?'active':''}" onclick="playMovie(${i}, ${idx})">${e.name}</div>`;
                });
            }
            document.getElementById('player-overlay').classList.remove('hidden');
        }

        function closePlayer() { document.getElementById('player-overlay').classList.add('hidden'); document.getElementById('main-iframe').src = ""; }
        init();
    </script>
</body>
</html>
