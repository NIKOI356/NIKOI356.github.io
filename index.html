<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>X√¥ Phim - Phim Hay C·∫£ X√¥</title>

<script src="https://cdn.tailwindcss.com"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

<style>
:root {
    --xo-vang:#d4a017;
    --bg-dark:#0b0c10;
}
body {
    background: var(--bg-dark);
    color:#eee;
    font-family: Inter, sans-serif;
    overflow-x:hidden;
}
header {
    position:fixed;
    top:0; left:0;
    width:100%;
    z-index:120;
    background:linear-gradient(to bottom, rgba(0,0,0,.9), rgba(0,0,0,.6), transparent);
}
.movie-card {
    border-radius:12px;
    overflow:hidden;
    cursor:pointer;
    transition:.3s;
}
.movie-card:hover {
    transform:scale(1.05);
}
.badge {
    font-size:10px;
    padding:3px 8px;
    border-radius:999px;
    background:rgba(0,0,0,.6);
}
.info-modal {
    display:none;
    position:fixed;
    inset:0;
    z-index:300;
    background:rgba(0,0,0,.85);
    backdrop-filter:blur(6px);
    align-items:center;
    justify-content:center;
}
</style>
</head>

<body>

<!-- HEADER -->
<header class="p-4 flex justify-between items-center">
    <div class="text-xl font-bold text-yellow-400 cursor-pointer" onclick="location.reload()">üçø X√î PHIM</div>
    <input id="search" placeholder="T√¨m phim..." class="bg-transparent border border-white/20 px-3 py-1 rounded text-sm">
</header>

<div class="pt-20"></div>

<!-- BANNER -->
<section id="banner" class="relative h-[55vh] flex items-end p-8 bg-cover bg-center">
    <div>
        <h1 id="banner-title" class="text-4xl font-bold mb-2"></h1>
        <div id="banner-badges" class="flex gap-2 mb-4"></div>
        <button id="banner-play" class="bg-yellow-500 text-black px-5 py-2 rounded font-bold">
            ‚ñ∂ Xem ngay
        </button>
    </div>
</section>

<!-- LIST -->
<section class="p-6">
    <h2 class="text-xl font-bold mb-4">üî• Phim m·ªõi c·∫≠p nh·∫≠t</h2>
    <div id="movie-list" class="grid grid-cols-2 md:grid-cols-5 gap-4"></div>
</section>

<!-- MODAL INFO -->
<div id="info-modal" class="info-modal flex">
    <div class="bg-[#111] w-full max-w-4xl rounded-xl overflow-hidden relative">
        <button onclick="closeInfoModal()" class="absolute top-3 right-4 text-xl">‚úñ</button>
        <div class="flex flex-col md:flex-row">
            <img id="modal-img" class="w-full md:w-1/3 object-cover">
            <div class="p-6 flex-1">
                <h2 id="modal-title" class="text-2xl font-bold mb-1"></h2>
                <p id="modal-sub" class="text-gray-400 mb-3"></p>
                <div id="modal-desc" class="text-sm text-gray-300 leading-relaxed mb-6"></div>
                <button id="modal-play-btn" class="bg-yellow-500 text-black px-4 py-2 rounded font-bold">
                    ‚ñ∂ Xem phim
                </button>
            </div>
        </div>
    </div>
</div>

<!-- PLAYER -->
<div id="player" class="hidden fixed inset-0 z-[400] bg-black">
    <button onclick="closePlayer()" class="absolute top-3 right-4 text-xl z-50">‚úñ</button>
    <iframe id="player-frame" class="w-full h-full" allowfullscreen></iframe>
</div>

<script>
let movies = [];
let currentIndex = 0;

// LOAD PHIM
fetch('https://phimapi.com/danh-sach/phim-moi-cap-nhat')
.then(r=>r.json())
.then(d=>{
    movies = d.items.slice(0,20);
    renderMovies();
    updateBanner(0);
});

function renderMovies(){
    const list = document.getElementById('movie-list');
    list.innerHTML='';
    movies.forEach((m,i)=>{
        list.innerHTML += `
        <div class="movie-card" onclick="showInfo(${i})">
            <img src="${m.poster_url}" class="w-full h-[260px] object-cover">
            <div class="mt-2 text-sm font-semibold">${m.name}</div>
        </div>`;
    });
}

function updateBanner(i){
    const m = movies[i];
    document.getElementById('banner').style.backgroundImage =
        `linear-gradient(to top, rgba(0,0,0,.9), transparent), url(${m.poster_url})`;
    document.getElementById('banner-title').innerText = m.name;
    document.getElementById('banner-badges').innerHTML = `
        <span class="badge">${m.year}</span>
        <span class="badge">${m.lang}</span>
    `;
    document.getElementById('banner-play').onclick = ()=>playMovie(i);
}

// MODAL INFO
async function showInfo(i){
    const m = movies[i];
    document.getElementById('info-modal').style.display='flex';
    document.getElementById('modal-desc').innerHTML='ƒêang t·∫£i th√¥ng tin...';

    const res = await fetch(`https://phimapi.com/phim/${m.slug}`);
    const data = await res.json();
    const info = data.movie;

    document.getElementById('modal-img').src = info.poster_url || m.poster_url;
    document.getElementById('modal-title').innerText = info.name;
    document.getElementById('modal-sub').innerText = info.origin_name;

    document.getElementById('modal-desc').innerHTML = `
        <b>NƒÉm:</b> ${info.year}<br>
        <b>Th·ªùi l∆∞·ª£ng:</b> ${info.time}<br>
        <b>Qu·ªëc gia:</b> ${info.country.map(c=>c.name).join(', ')}<br>
        <b>Th·ªÉ lo·∫°i:</b> ${info.category.map(c=>c.name).join(', ')}<br>
        <b>Di·ªÖn vi√™n:</b> ${info.actor.slice(0,6).join(', ')}<br><br>
        ${info.content}
    `;

    document.getElementById('modal-play-btn').onclick=()=>{
        closeInfoModal();
        playMovie(i);
    };
}

function closeInfoModal(){
    document.getElementById('info-modal').style.display='none';
}

// PLAYER
async function playMovie(i){
    const m = movies[i];
    const res = await fetch(`https://phimapi.com/phim/${m.slug}`);
    const data = await res.json();
    const ep = data.episodes[0].server_data[0];

    document.getElementById('player').classList.remove('hidden');
    document.getElementById('player-frame').src = ep.link_embed;
}

function closePlayer(){
    document.getElementById('player').classList.add('hidden');
    document.getElementById('player-frame').src='';
}
</script>

</body>
</html>
